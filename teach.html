<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #2a2c33; -webkit-text-stroke: #2a2c33; background-color: #ffffff}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #db3f39; -webkit-text-stroke: #db3f39; background-color: #ffffff}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #42933e; -webkit-text-stroke: #42933e; background-color: #ffffff}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #2a2c33; -webkit-text-stroke: #2a2c33; background-color: #ffffff; min-height: 16.0px}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #8f9096; -webkit-text-stroke: #8f9096; background-color: #ffffff}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #325eee; -webkit-text-stroke: #325eee; background-color: #ffffff}
    span.s1 {font-kerning: none}
    span.s2 {font-kerning: none; color: #db3f39; -webkit-text-stroke: 0px #db3f39}
    span.s3 {font-kerning: none; color: #a75705; -webkit-text-stroke: 0px #a75705}
    span.s4 {font-kerning: none; color: #42933e; -webkit-text-stroke: 0px #42933e}
    span.s5 {font-kerning: none; color: #2a2c33; -webkit-text-stroke: 0px #2a2c33}
    span.s6 {font-kerning: none; color: #930093; -webkit-text-stroke: 0px #930093}
    span.s7 {font-kerning: none; color: #325eee; -webkit-text-stroke: 0px #325eee}
    span.s8 {font-kerning: none; color: #8f9096; -webkit-text-stroke: 0px #8f9096}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;</span><span class="s2">html </span><span class="s3">lang</span><span class="s1">="</span><span class="s4">ja</span><span class="s1">"&gt;</span></p>
<p class="p2"><span class="s5">&lt;</span><span class="s1">head</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">meta </span><span class="s3">charset</span><span class="s1">="</span><span class="s4">UTF-8</span><span class="s1">"&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">meta </span><span class="s3">name</span><span class="s5">="</span><span class="s1">viewport</span><span class="s5">"</span><span class="s2"> </span><span class="s3">content</span><span class="s5">="</span><span class="s1">width=device-width, initial-scale=1.0</span><span class="s5">"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">title</span><span class="s1">&gt;Teachable Machine Pose Model with Sound&lt;/</span><span class="s2">title</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s5">&lt;/</span><span class="s1">head</span><span class="s5">&gt;</span></p>
<p class="p2"><span class="s5">&lt;</span><span class="s1">body</span><span class="s5">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">div</span><span class="s1">&gt;Teachable Machine Pose Model&lt;/</span><span class="s2">div</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">button </span><span class="s3">type</span><span class="s1">="</span><span class="s4">button</span><span class="s1">"</span><span class="s2"> </span><span class="s3">onclick</span><span class="s1">="</span><span class="s4">init()</span><span class="s1">"&gt;Start&lt;/</span><span class="s2">button</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s1">div</span><span class="s5">&gt;&lt;</span><span class="s1">canvas </span><span class="s3">id</span><span class="s5">="</span><span class="s4">canvas</span><span class="s5">"&gt;&lt;/</span><span class="s1">canvas</span><span class="s5">&gt;&lt;/</span><span class="s1">div</span><span class="s5">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">div </span><span class="s3">id</span><span class="s5">="</span><span class="s1">label-container</span><span class="s5">"&gt;&lt;/</span><span class="s2">div</span><span class="s5">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">script </span><span class="s3">src</span><span class="s5">="</span><span class="s1">https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js</span><span class="s5">"&gt;&lt;/</span><span class="s2">script</span><span class="s5">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">script </span><span class="s3">src</span><span class="s5">="</span><span class="s1">https://cdn.jsdelivr.net/npm/@teachablemachine/pose@0.8/dist/teachablemachine-pose.min.js</span><span class="s5">"&gt;&lt;/</span><span class="s2">script</span><span class="s5">&gt;</span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">    </span>&lt;</span><span class="s2">script </span><span class="s3">type</span><span class="s5">="</span><span class="s1">text/javascript</span><span class="s5">"&gt;</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">        </span></span><span class="s1"><i>// More API functions here:</i><i></i></span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">        </span></span><span class="s1"><i>// https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/pose</i><i></i></span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">        </span></span><span class="s1"><i>// the link to your model provided by Teachable Machine export panel</i><i></i></span></p>
<p class="p3"><span class="s5"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s5"> </span><span class="s3">URL</span><span class="s5"> </span><span class="s7">=</span><span class="s5"> </span><span class="s1">"https://teachablemachine.withgoogle.com/models/j6Njq_qYL/"</span><span class="s5">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">let</span><span class="s1"> model, webcam, ctx, labelContainer, maxPredictions;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">let</span><span class="s1"> lastSoundTime </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">; </span><span class="s8"><i>// 音の連続再生を防ぐためのタイムスタンプ</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">const</span><span class="s1"> soundCooldown </span><span class="s7">=</span><span class="s1"> </span><span class="s3">1000</span><span class="s1">; </span><span class="s8"><i>// 1秒間のクールダウン時間（ミリ秒）</i><i></i></span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">        </span></span><span class="s1"><i>// ピンポン音を作成する関数</i><i></i></span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">        </span></span><span class="s6">function</span><span class="s5"> </span><span class="s1">createPingPongSound</span><span class="s5">() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> audioContext </span><span class="s7">=</span><span class="s1"> </span><span class="s6">new</span><span class="s1"> (</span><span class="s7">window</span><span class="s1">.AudioContext </span><span class="s7">||</span><span class="s1"> </span><span class="s7">window</span><span class="s1">.webkitAudioContext)();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8"><i>// 高い音（ピン）</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> oscillator1 </span><span class="s7">=</span><span class="s1"> audioContext.</span><span class="s7">createOscillator</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> gainNode1 </span><span class="s7">=</span><span class="s1"> audioContext.</span><span class="s7">createGain</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>oscillator1.type </span><span class="s7">=</span><span class="s1"> </span><span class="s4">'sine'</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>oscillator1.frequency.</span><span class="s7">setValueAtTime</span><span class="s1">(</span><span class="s3">800</span><span class="s1">, audioContext.currentTime);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gainNode1.gain.</span><span class="s7">setValueAtTime</span><span class="s1">(</span><span class="s3">0.3</span><span class="s1">, audioContext.currentTime);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gainNode1.gain.</span><span class="s7">exponentialRampToValueAtTime</span><span class="s1">(</span><span class="s3">0.01</span><span class="s1">, audioContext.currentTime </span><span class="s7">+</span><span class="s1"> </span><span class="s3">0.1</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>oscillator1.</span><span class="s7">connect</span><span class="s1">(gainNode1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>gainNode1.</span><span class="s7">connect</span><span class="s1">(audioContext.destination);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>oscillator1.</span><span class="s7">start</span><span class="s1">(audioContext.currentTime);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>oscillator1.</span><span class="s7">stop</span><span class="s1">(audioContext.currentTime </span><span class="s7">+</span><span class="s1"> </span><span class="s3">0.1</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8"><i>// 低い音（ポン）</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">setTimeout</span><span class="s1">(() </span><span class="s7">=&gt;</span><span class="s1"> {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> oscillator2 </span><span class="s7">=</span><span class="s1"> audioContext.</span><span class="s7">createOscillator</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> gainNode2 </span><span class="s7">=</span><span class="s1"> audioContext.</span><span class="s7">createGain</span><span class="s1">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>oscillator2.type </span><span class="s7">=</span><span class="s1"> </span><span class="s4">'sine'</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>oscillator2.frequency.</span><span class="s7">setValueAtTime</span><span class="s1">(</span><span class="s3">600</span><span class="s1">, audioContext.currentTime);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>gainNode2.gain.</span><span class="s7">setValueAtTime</span><span class="s1">(</span><span class="s3">0.3</span><span class="s1">, audioContext.currentTime);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>gainNode2.gain.</span><span class="s7">exponentialRampToValueAtTime</span><span class="s1">(</span><span class="s3">0.01</span><span class="s1">, audioContext.currentTime </span><span class="s7">+</span><span class="s1"> </span><span class="s3">0.1</span><span class="s1">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>oscillator2.</span><span class="s7">connect</span><span class="s1">(gainNode2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>gainNode2.</span><span class="s7">connect</span><span class="s1">(audioContext.destination);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>oscillator2.</span><span class="s7">start</span><span class="s1">(audioContext.currentTime);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>oscillator2.</span><span class="s7">stop</span><span class="s1">(audioContext.currentTime </span><span class="s7">+</span><span class="s1"> </span><span class="s3">0.1</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}, </span><span class="s3">100</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">async</span><span class="s1"> </span><span class="s6">function</span><span class="s1"> </span><span class="s7">init</span><span class="s1">() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> modelURL </span><span class="s7">=</span><span class="s1"> </span><span class="s3">URL</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> </span><span class="s4">"model.json"</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> metadataURL </span><span class="s7">=</span><span class="s1"> </span><span class="s3">URL</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> </span><span class="s4">"metadata.json"</span><span class="s1">;</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1"><i>// load the model and metadata</i><i></i></span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1"><i>// Refer to tmImage.loadFromFiles() in the API to support files from a file picker</i><i></i></span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1"><i>// Note: the pose library adds a tmPose object to your window (window.tmPose)</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>model </span><span class="s7">=</span><span class="s1"> </span><span class="s6">await</span><span class="s1"> tmPose.</span><span class="s7">load</span><span class="s1">(modelURL, metadataURL);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>maxPredictions </span><span class="s7">=</span><span class="s1"> model.</span><span class="s7">getTotalClasses</span><span class="s1">();</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1"><i>// Convenience function to setup a webcam</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> size </span><span class="s7">=</span><span class="s1"> </span><span class="s3">200</span><span class="s1">;</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s5"> flip </span><span class="s7">=</span><span class="s5"> </span><span class="s3">true</span><span class="s5">; </span><span class="s1"><i>// whether to flip the webcam</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>webcam </span><span class="s7">=</span><span class="s1"> </span><span class="s6">new</span><span class="s1"> </span><span class="s3">tmPose</span><span class="s1">.</span><span class="s3">Webcam</span><span class="s1">(size, size, flip); </span><span class="s8"><i>// width, height, flip</i><i></i></span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s6">await</span><span class="s5"> webcam.</span><span class="s7">setup</span><span class="s5">(); </span><span class="s1"><i>// request access to the webcam</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">await</span><span class="s1"> webcam.</span><span class="s7">play</span><span class="s1">();</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1">window</span><span class="s5">.</span><span class="s1">requestAnimationFrame</span><span class="s5">(loop);</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1"><i>// append/get elements to the DOM</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> canvas </span><span class="s7">=</span><span class="s1"> </span><span class="s7">document</span><span class="s1">.</span><span class="s7">getElementById</span><span class="s1">(</span><span class="s4">"canvas"</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>canvas.width </span><span class="s7">=</span><span class="s1"> size; canvas.height </span><span class="s7">=</span><span class="s1"> size;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ctx </span><span class="s7">=</span><span class="s1"> canvas.</span><span class="s7">getContext</span><span class="s1">(</span><span class="s4">"2d"</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>labelContainer </span><span class="s7">=</span><span class="s1"> </span><span class="s7">document</span><span class="s1">.</span><span class="s7">getElementById</span><span class="s1">(</span><span class="s4">"label-container"</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">for</span><span class="s1"> (</span><span class="s6">let</span><span class="s1"> i </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">; i </span><span class="s7">&lt;</span><span class="s1"> maxPredictions; i</span><span class="s7">++</span><span class="s1">) { </span><span class="s8"><i>// and class labels</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>labelContainer.</span><span class="s7">appendChild</span><span class="s1">(</span><span class="s7">document</span><span class="s1">.</span><span class="s7">createElement</span><span class="s1">(</span><span class="s4">"div"</span><span class="s1">));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">async</span><span class="s1"> </span><span class="s6">function</span><span class="s1"> </span><span class="s7">loop</span><span class="s1">(timestamp) {</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span>webcam.</span><span class="s7">update</span><span class="s5">(); </span><span class="s1"><i>// update the webcam frame</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">await</span><span class="s1"> </span><span class="s7">predict</span><span class="s1">();</span></p>
<p class="p6"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1">window</span><span class="s5">.</span><span class="s1">requestAnimationFrame</span><span class="s5">(loop);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">async</span><span class="s1"> </span><span class="s6">function</span><span class="s1"> </span><span class="s7">predict</span><span class="s1">() {</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1"><i>// Prediction #1: run input through posenet</i><i></i></span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1"><i>// estimatePose can take in an image, video or canvas html element</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> { pose, posenetOutput } </span><span class="s7">=</span><span class="s1"> </span><span class="s6">await</span><span class="s1"> model.</span><span class="s7">estimatePose</span><span class="s1">(webcam.canvas);</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1"><i>// Prediction 2: run input through teachable machine classification model</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">const</span><span class="s1"> prediction </span><span class="s7">=</span><span class="s1"> </span><span class="s6">await</span><span class="s1"> model.</span><span class="s7">predict</span><span class="s1">(posenetOutput);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">for</span><span class="s1"> (</span><span class="s6">let</span><span class="s1"> i </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0</span><span class="s1">; i </span><span class="s7">&lt;</span><span class="s1"> maxPredictions; i</span><span class="s7">++</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">const</span><span class="s1"> classPrediction </span><span class="s7">=</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>prediction[i].className </span><span class="s7">+</span><span class="s1"> </span><span class="s4">": "</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> prediction[i].probability.</span><span class="s7">toFixed</span><span class="s1">(</span><span class="s3">2</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>labelContainer.childNodes[i].innerHTML </span><span class="s7">=</span><span class="s1"> classPrediction;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s1"><i>// Class1が80%以上の場合に音を鳴らす</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (prediction[i].className </span><span class="s7">===</span><span class="s1"> </span><span class="s4">"Class 1"</span><span class="s1"> </span><span class="s7">&amp;&amp;</span><span class="s1"> prediction[i].probability </span><span class="s7">&gt;=</span><span class="s1"> </span><span class="s3">0.8</span><span class="s1">) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> currentTime </span><span class="s7">=</span><span class="s1"> </span><span class="s3">Date</span><span class="s1">.</span><span class="s7">now</span><span class="s1">();</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">                    </span></span><span class="s1"><i>// クールダウン時間をチェックして連続音を防ぐ</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">if</span><span class="s1"> (currentTime </span><span class="s7">-</span><span class="s1"> lastSoundTime </span><span class="s7">&gt;</span><span class="s1"> soundCooldown) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s7">createPingPongSound</span><span class="s1">();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>lastSoundTime </span><span class="s7">=</span><span class="s1"> currentTime;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">console</span><span class="s1">.</span><span class="s7">log</span><span class="s1">(</span><span class="s4">"Class 1 detected with "</span><span class="s1"> </span><span class="s7">+</span><span class="s1"> (prediction[i].probability </span><span class="s7">*</span><span class="s1"> </span><span class="s3">100</span><span class="s1">).</span><span class="s7">toFixed</span><span class="s1">(</span><span class="s3">1</span><span class="s1">) </span><span class="s7">+</span><span class="s1"> </span><span class="s4">"% confidence!"</span><span class="s1">);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">            </span></span><span class="s1"><i>// finally draw the poses</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">drawPose</span><span class="s1">(pose);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">function</span><span class="s1"> </span><span class="s7">drawPose</span><span class="s1">(pose) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s6">if</span><span class="s1"> (webcam.canvas) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>ctx.</span><span class="s7">drawImage</span><span class="s1">(webcam.canvas, </span><span class="s3">0</span><span class="s1">, </span><span class="s3">0</span><span class="s1">);</span></p>
<p class="p5"><span class="s5"><span class="Apple-converted-space">                </span></span><span class="s1"><i>// draw the keypoints and skeleton</i><i></i></span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s6">if</span><span class="s1"> (pose) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s6">const</span><span class="s1"> minPartConfidence </span><span class="s7">=</span><span class="s1"> </span><span class="s3">0.5</span><span class="s1">;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>tmPose.</span><span class="s7">drawKeypoints</span><span class="s1">(pose.keypoints, minPartConfidence, ctx);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>tmPose.</span><span class="s7">drawSkeleton</span><span class="s1">(pose.keypoints, minPartConfidence, ctx);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/</span><span class="s2">script</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s5">&lt;/</span><span class="s1">body</span><span class="s5">&gt;</span></p>
<p class="p2"><span class="s5">&lt;/</span><span class="s1">html</span><span class="s5">&gt;</span></p>
</body>
</html>
